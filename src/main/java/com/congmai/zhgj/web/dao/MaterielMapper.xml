<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.congmai.zhgj.web.dao.MaterielMapper" >

  <resultMap id="BaseResultMap" type="com.congmai.zhgj.web.model.Materiel" >
    <id column="serialNum" property="serialNum" jdbcType="VARCHAR" />
    <result column="materielId" property="materielId" jdbcType="VARCHAR" />
    <result column="materielNum" property="materielNum" jdbcType="VARCHAR" />
    <result column="materielName" property="materielName" jdbcType="VARCHAR" />
    <result column="specifications" property="specifications" jdbcType="VARCHAR" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="parentMaterielSerial" property="parentMaterielSerial" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="productionPlace" property="productionPlace" jdbcType="VARCHAR" />
    <result column="brand" property="brand" jdbcType="VARCHAR" />
    <result column="category1" property="category1" jdbcType="VARCHAR" />
    <result column="category2" property="category2" jdbcType="VARCHAR" />
    <result column="category3" property="category3" jdbcType="VARCHAR" />
    <result column="materielAttribute" property="materielAttribute" jdbcType="VARCHAR" />
    <result column="MnemonicCode" property="mnemonicCode" jdbcType="VARCHAR" />
    <result column="isBOM" property="isBOM" jdbcType="VARCHAR" />
    <result column="stockUnit" property="stockUnit" jdbcType="VARCHAR" />
    <result column="originCountry" property="originCountry" jdbcType="VARCHAR" />
    <result column="width" property="width" jdbcType="VARCHAR" />
    <result column="height" property="height" jdbcType="VARCHAR" />
    <result column="length" property="length" jdbcType="VARCHAR" />
    <result column="currency" property="currency" jdbcType="VARCHAR" />
    <result column="unitPrice" property="unitPrice" jdbcType="VARCHAR" />
    <result column="deliveryCycle" property="deliveryCycle" jdbcType="VARCHAR" />
    <result column="filingItemNo" property="filingItemNo" jdbcType="VARCHAR" />
    <result column="volume" property="volume" jdbcType="VARCHAR" />
    <result column="weight" property="weight" jdbcType="VARCHAR" />
    <result column="palletSpecification" property="palletSpecification" jdbcType="VARCHAR" />
    <result column="manufactureDate" property="manufactureDate" jdbcType="DATE" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="packageNum" property="packageNum" jdbcType="VARCHAR" />
    <result column="packageSpecifications" property="packageSpecifications" jdbcType="VARCHAR" />
    <result column="packageUnit" property="packageUnit" jdbcType="VARCHAR" />
    <result column="packagewidth" property="packagewidth" jdbcType="VARCHAR" />
    <result column="packageheight" property="packageheight" jdbcType="VARCHAR" />
    <result column="packagelength" property="packagelength" jdbcType="VARCHAR" />
    <result column="packagevolume" property="packagevolume" jdbcType="VARCHAR" />
    <result column="packageUnitConversion" property="packageUnitConversion" jdbcType="VARCHAR" />
    <result column="palletWeight" property="palletWeight" jdbcType="VARCHAR" />
    <result column="customsSupervisionConditions" property="customsSupervisionConditions" jdbcType="VARCHAR" />
    <result column="customsCode" property="customsCode" jdbcType="VARCHAR" />
    <result column="qualityDate" property="qualityDate" jdbcType="VARCHAR" />
    <result column="versionNO" property="versionNO" jdbcType="VARCHAR" />
    <result column="isLatestVersion" property="isLatestVersion" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="delFlg" property="delFlg" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createTime" property="createTime" jdbcType="TIMESTAMP" />
    <result column="updater" property="updater" jdbcType="VARCHAR" />
    <result column="updateTime" property="updateTime" jdbcType="TIMESTAMP" />
    <!-- <association property="parentMateriel" column="parentMaterielSerial" select="com.congmai.zhgj.web.dao.MaterielMapper.selectByPrimaryKey"/>  -->
    <association property="typeName" column="type" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName1" column="category1" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName2" column="category2" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName3" column="category3" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <!-- 查询库存数量，影响查询效率 -->
    <association property="stockCount" column="serialNum" select="com.congmai.zhgj.web.dao.StockInOutRecordMapper.getMaterielZiJianStock"/>
    <!-- 查询物料指导单价,没有显示无 有过期了为已过期 -->
    <!-- <association property="guideUnitPrice" column="serialNum" select="com.congmai.zhgj.web.dao.PriceListMapper.getGuideUnitPrice"/> -->
    <collection property="supplyMateriels" column="materielId" select="com.congmai.zhgj.web.dao.SupplyMaterielMapper.selectSupplyMaterielByMaterielId"/> 

    
  </resultMap>
  
  <resultMap id="BaseResultMap4list" type="com.congmai.zhgj.web.model.Materiel" >
    <id column="serialNum" property="serialNum" jdbcType="VARCHAR" />
    <result column="materielId" property="materielId" jdbcType="VARCHAR" />
    <result column="materielNum" property="materielNum" jdbcType="VARCHAR" />
    <result column="materielName" property="materielName" jdbcType="VARCHAR" />
    <result column="specifications" property="specifications" jdbcType="VARCHAR" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="parentMaterielSerial" property="parentMaterielSerial" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="productionPlace" property="productionPlace" jdbcType="VARCHAR" />
    <result column="brand" property="brand" jdbcType="VARCHAR" />
    <result column="typeName" property="typeName" jdbcType="VARCHAR" />
    <result column="isBOM" property="isBOM" jdbcType="VARCHAR" />
    <!-- <result column="category1" property="category1" jdbcType="VARCHAR" />
    <result column="category2" property="category2" jdbcType="VARCHAR" />
    <result column="category3" property="category3" jdbcType="VARCHAR" />
    <result column="materielAttribute" property="materielAttribute" jdbcType="VARCHAR" />
    <result column="MnemonicCode" property="mnemonicCode" jdbcType="VARCHAR" />
    <result column="isBOM" property="isBOM" jdbcType="VARCHAR" />
    <result column="stockUnit" property="stockUnit" jdbcType="VARCHAR" />-->
    <result column="originCountry" property="originCountry" jdbcType="VARCHAR" />
    <!-- <result column="width" property="width" jdbcType="VARCHAR" />
    <result column="height" property="height" jdbcType="VARCHAR" />
    <result column="length" property="length" jdbcType="VARCHAR" />
    <result column="currency" property="currency" jdbcType="VARCHAR" />
    <result column="unitPrice" property="unitPrice" jdbcType="VARCHAR" />
    <result column="deliveryCycle" property="deliveryCycle" jdbcType="VARCHAR" />
    <result column="filingItemNo" property="filingItemNo" jdbcType="VARCHAR" />
    <result column="volume" property="volume" jdbcType="VARCHAR" />
    <result column="weight" property="weight" jdbcType="VARCHAR" />
    <result column="palletSpecification" property="palletSpecification" jdbcType="VARCHAR" />
    <result column="manufactureDate" property="manufactureDate" jdbcType="DATE" /> -->
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <!-- <result column="packageNum" property="packageNum" jdbcType="VARCHAR" />
    <result column="packageSpecifications" property="packageSpecifications" jdbcType="VARCHAR" />
    <result column="packageUnit" property="packageUnit" jdbcType="VARCHAR" />
    <result column="packagewidth" property="packagewidth" jdbcType="VARCHAR" />
    <result column="packageheight" property="packageheight" jdbcType="VARCHAR" />
    <result column="packagelength" property="packagelength" jdbcType="VARCHAR" />
    <result column="packagevolume" property="packagevolume" jdbcType="VARCHAR" />
    <result column="packageUnitConversion" property="packageUnitConversion" jdbcType="VARCHAR" />
    <result column="palletWeight" property="palletWeight" jdbcType="VARCHAR" />
    <result column="customsSupervisionConditions" property="customsSupervisionConditions" jdbcType="VARCHAR" />
    <result column="customsCode" property="customsCode" jdbcType="VARCHAR" />
    <result column="qualityDate" property="qualityDate" jdbcType="VARCHAR" /> -->
    <result column="versionNO" property="versionNO" jdbcType="VARCHAR" />
    <result column="isLatestVersion" property="isLatestVersion" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="delFlg" property="delFlg" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createTime" property="createTime" jdbcType="TIMESTAMP" />
    <result column="updater" property="updater" jdbcType="VARCHAR" />
    <result column="updateTime" property="updateTime" jdbcType="TIMESTAMP" />
    <!-- <association property="parentMateriel" column="parentMaterielSerial" select="com.congmai.zhgj.web.dao.MaterielMapper.selectByPrimaryKey"/>  -->
    <!-- <association property="typeName" column="type" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/> -->
<!--     <association property="categoryName1" column="category1" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName2" column="category2" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName3" column="category3" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/> -->
    <!-- 查询库存数量，影响查询效率 -->
    <association property="stockCount" column="serialNum" select="com.congmai.zhgj.web.dao.StockInOutRecordMapper.getMaterielZiJianStock"/>
    <!-- 查询物料指导单价,没有显示无 有过期了为已过期 -->
    <!-- <association property="guideUnitPrice" column="serialNum" select="com.congmai.zhgj.web.dao.PriceListMapper.getGuideUnitPrice"/> -->
    <!-- <collection property="supplyMateriels" column="materielId" select="com.congmai.zhgj.web.dao.SupplyMaterielMapper.selectSupplyMaterielByMaterielId4materielList"/> --> 
    <collection property="supplyMateriels" ofType="com.congmai.zhgj.web.model.SupplyMateriel">
    	<result column="sm_serialNum" property="serialNum" jdbcType="VARCHAR" />
	    <result column="sm_materielId" property="materielId" jdbcType="VARCHAR" />
	    <result column="sm_supplyComId" property="supplyComId" jdbcType="VARCHAR" />
	    <result column="sm_supplyMaterielNum" property="supplyMaterielNum" jdbcType="VARCHAR" />
	   <!--  <result column="sm_packageNum" property="packageNum" jdbcType="VARCHAR" />
	    <result column="sm_packageSpecifications" property="packageSpecifications" jdbcType="VARCHAR" />
	    <result column="sm_packageUnit" property="packageUnit" jdbcType="VARCHAR" />
	    <result column="sm_packagewidth" property="packagewidth" jdbcType="VARCHAR" />
	    <result column="sm_packageheight" property="packageheight" jdbcType="VARCHAR" />
	    <result column="sm_packagelength" property="packagelength" jdbcType="VARCHAR" />
	    <result column="sm_packagevolume" property="packagevolume" jdbcType="VARCHAR" />
	    <result column="sm_packageUnitConversion" property="packageUnitConversion" jdbcType="VARCHAR" />
	    <result column="sm_delFlg" property="delFlg" jdbcType="VARCHAR" />
	    <result column="sm_creator" property="creator" jdbcType="VARCHAR" />
	    <result column="sm_createTime" property="createTime" jdbcType="TIMESTAMP" />
	    <result column="sm_updater" property="updater" jdbcType="VARCHAR" />
	    <result column="sm_updateTime" property="updateTime" jdbcType="TIMESTAMP" />
	    <result column="sm_remark" property="remark" jdbcType="VARCHAR" />
	    <result column="sm_materielName" property="materielName" jdbcType="VARCHAR" />
	    <result column="sm_specifications" property="specifications" jdbcType="VARCHAR" />
	    <result column="sm_unit" property="unit" jdbcType="VARCHAR" />
	    <result column="sm_type" property="type" jdbcType="VARCHAR" />
	    <result column="sm_category1" property="category1" jdbcType="VARCHAR" />
	    <result column="sm_category2" property="category2" jdbcType="VARCHAR" />
	    <result column="sm_category3" property="category3" jdbcType="VARCHAR" />
	    <result column="sm_unitPriceGuide" property="unitPriceGuide" jdbcType="VARCHAR" />
	    <result column="sm_purchaseQuota" property="purchaseQuota" jdbcType="VARCHAR" />
	    <result column="sm_moq" property="moq" jdbcType="VARCHAR" /> -->
	    <association property="supply" javaType="com.congmai.zhgj.web.model.Company">
	    	<result column="supply_comId" property="comId" jdbcType="VARCHAR" />
		    <result column="supply_comNum" property="comNum" jdbcType="VARCHAR" />
		    <result column="supply_comType" property="comType" jdbcType="VARCHAR" />
		    <result column="supply_tradeType" property="tradeType" jdbcType="VARCHAR" />
		    <result column="supply_comName" property="comName" jdbcType="VARCHAR" />
	    </association>
	    <!-- <association property="supply" column="sm_supplyComId" select="com.congmai.zhgj.web.dao.CompanyMapper.selectByPrimaryKey"/> -->
	</collection>
  </resultMap>
  
  <resultMap id="BaseResultMap4Order" type="com.congmai.zhgj.web.model.Materiel" >
    <id column="serialNum" property="serialNum" jdbcType="VARCHAR" />
    <result column="materielId" property="materielId" jdbcType="VARCHAR" />
    <result column="materielNum" property="materielNum" jdbcType="VARCHAR" />
    <result column="materielName" property="materielName" jdbcType="VARCHAR" />
    <result column="specifications" property="specifications" jdbcType="VARCHAR" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="parentMaterielSerial" property="parentMaterielSerial" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="productionPlace" property="productionPlace" jdbcType="VARCHAR" />
    <result column="brand" property="brand" jdbcType="VARCHAR" />
    <result column="category1" property="category1" jdbcType="VARCHAR" />
    <result column="category2" property="category2" jdbcType="VARCHAR" />
    <result column="category3" property="category3" jdbcType="VARCHAR" />
    <result column="materielAttribute" property="materielAttribute" jdbcType="VARCHAR" />
    <result column="MnemonicCode" property="mnemonicCode" jdbcType="VARCHAR" />
    <result column="isBOM" property="isBOM" jdbcType="VARCHAR" />
    <result column="stockUnit" property="stockUnit" jdbcType="VARCHAR" />
    <result column="originCountry" property="originCountry" jdbcType="VARCHAR" />
    <result column="width" property="width" jdbcType="VARCHAR" />
    <result column="height" property="height" jdbcType="VARCHAR" />
    <result column="length" property="length" jdbcType="VARCHAR" />
    <result column="currency" property="currency" jdbcType="VARCHAR" />
    <result column="unitPrice" property="unitPrice" jdbcType="VARCHAR" />
    <result column="deliveryCycle" property="deliveryCycle" jdbcType="VARCHAR" />
    <result column="filingItemNo" property="filingItemNo" jdbcType="VARCHAR" />
    <result column="volume" property="volume" jdbcType="VARCHAR" />
    <result column="weight" property="weight" jdbcType="VARCHAR" />
    <result column="palletSpecification" property="palletSpecification" jdbcType="VARCHAR" />
    <result column="manufactureDate" property="manufactureDate" jdbcType="DATE" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="packageNum" property="packageNum" jdbcType="VARCHAR" />
    <result column="packageSpecifications" property="packageSpecifications" jdbcType="VARCHAR" />
    <result column="packageUnit" property="packageUnit" jdbcType="VARCHAR" />
    <result column="packagewidth" property="packagewidth" jdbcType="VARCHAR" />
    <result column="packageheight" property="packageheight" jdbcType="VARCHAR" />
    <result column="packagelength" property="packagelength" jdbcType="VARCHAR" />
    <result column="packagevolume" property="packagevolume" jdbcType="VARCHAR" />
    <result column="packageUnitConversion" property="packageUnitConversion" jdbcType="VARCHAR" />
    <result column="palletWeight" property="palletWeight" jdbcType="VARCHAR" />
    <result column="customsSupervisionConditions" property="customsSupervisionConditions" jdbcType="VARCHAR" />
    <result column="customsCode" property="customsCode" jdbcType="VARCHAR" />
    <result column="qualityDate" property="qualityDate" jdbcType="VARCHAR" />
    <result column="versionNO" property="versionNO" jdbcType="VARCHAR" />
    <result column="isLatestVersion" property="isLatestVersion" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="delFlg" property="delFlg" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createTime" property="createTime" jdbcType="TIMESTAMP" />
    <result column="updater" property="updater" jdbcType="VARCHAR" />
    <result column="updateTime" property="updateTime" jdbcType="TIMESTAMP" />
    <!-- <association property="parentMateriel" column="parentMaterielSerial" select="com.congmai.zhgj.web.dao.MaterielMapper.selectByPrimaryKey"/>  -->
    <association property="typeName" column="type" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName1" column="category1" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName2" column="category2" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <association property="categoryName3" column="category3" select="com.congmai.zhgj.web.dao.CategoryMapper.selectNameByPrimaryKey"/>
    <collection property="supplyMateriels" column="materielId" select="com.congmai.zhgj.web.dao.SupplyMaterielMapper.selectSupplyMaterielByMaterielId"/> 
  </resultMap>
  <sql id="Example_Where_Clause" >
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    serialNum, materielId, materielNum, materielName, specifications, unit, parentMaterielSerial, 
    type, productionPlace, brand, category1,category2, category3,materielAttribute, MnemonicCode, isBOM, stockUnit, originCountry, 
    width, height, length, currency, unitPrice, deliveryCycle,filingItemNo, volume, weight, palletSpecification, 
    manufactureDate, remark, packageNum, packageSpecifications, packageUnit, packagewidth, 
    packageheight, packagelength, packagevolume, packageUnitConversion, palletWeight, 
    customsSupervisionConditions,customsCode, qualityDate, versionNO, isLatestVersion, status, delFlg, 
    creator, createTime, updater, updateTime
  </sql>
  <sql id="Base_Column_List2" >
    m.serialNum, m.materielId, m.materielNum, m.materielName, m.specifications, m.unit, m.parentMaterielSerial, 
    m.type, m.productionPlace, m.brand, m.category1,m.category2, m.category3,m.materielAttribute, m.MnemonicCode, m.isBOM, m.stockUnit, m.originCountry, 
    m.width, m.height, m.length, m.currency, m.unitPrice, m.deliveryCycle,m.filingItemNo, m.volume, m.weight, m.palletSpecification, 
    m.manufactureDate, m.remark, m.packageNum, m.packageSpecifications, m.packageUnit, m.packagewidth, 
    m.packageheight, m.packagelength, m.packagevolume, m.packageUnitConversion, m.palletWeight, 
    m.customsSupervisionConditions, m.qualityDate, m.versionNO, m.isLatestVersion, m.status, m.delFlg, 
    m.creator, m.createTime, m.updater, m.updateTime
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.congmai.zhgj.web.model.MaterielExample" >
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from materiel
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  
  <select id="selectByExample4list" resultMap="BaseResultMap4list" parameterType="com.congmai.zhgj.web.model.MaterielExample" >
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from materiel
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  
  <select id="selectBySelectExample" resultMap="BaseResultMap4list" parameterType="com.congmai.zhgj.web.model.MaterielSelectExample" >
 select * from(   SELECT DISTINCT
m.serialNum,
m.materielId,
m.materielNum,
m.materielName,
m.specifications,
m.unit,
m.parentMaterielSerial,
m.type,
ca.categoryName as typeName,
m.productionPlace,
m.brand,
m.isBOM,
<!-- m.category1,
m.category2,
m.category3,
m.materielAttribute,
m.mnemonicCode,
m.isBOM,
m.stockUnit,
m.originCountry,
m.width,
m.height,
m.length,
m.currency,
m.unitPrice,
m.deliveryCycle,
m.filingItemNo,
m.volume,
m.weight,
m.palletSpecification,
m.manufactureDate, -->
m.remark,
<!-- m.packageNum,
m.packageSpecifications,
m.packageUnit,
m.packagewidth,
m.packageheight,
m.packagelength,
m.packagevolume,
m.packageUnitConversion,
m.palletWeight,
m.customsSupervisionConditions,
m.qualityDate, -->
m.versionNO,
m.isLatestVersion,
m.`status`,
m.delFlg,
m.creator,
m.createTime,
m.updater,
m.updateTime,
sm.serialNum AS sm_serialNum,
sm.materielId		sm_materielId,
sm.supplyComId		sm_supplyComId,
sm.supplyMaterielNum		sm_supplyMaterielNum,
<!-- sm.packageNum		sm_packageNum,
sm.packageSpecifications		sm_packageSpecifications,
sm.packageUnit		sm_packageUnit,
sm.packagewidth		sm_packagewidth,
sm.packageheight		sm_packageheight,
sm.packagelength		sm_packagelength,
sm.packagevolume		sm_packagevolume,
sm.packageUnitConversion		sm_packageUnitConversion,
sm.delFlg		sm_delFlg,
sm.creator		sm_creator,
sm.createTime		sm_createTime,
sm.updater		sm_updater,
sm.updateTime		sm_updateTime,
sm.remark		sm_remark,
sm.materielName		sm_materielName,
sm.specifications		sm_specifications,
sm.unit		sm_unit,
sm.type		sm_type,
sm.category1		sm_category1,
sm.category2		sm_category2,
sm.category3		sm_category3,
sm.unitPriceGuide		sm_unitPriceGuide,
sm.purchaseQuota		sm_purchaseQuota,
sm.moq		sm_moq, -->
supply.comId supply_comId,
supply.comNum supply_comNum, supply.comType supply_comType,supply.tradeType supply_tradeType,supply.comName supply_comName
from materiel m 
    left join supplyMateriel sm on sm.materielId = m.materielId and sm.delFlg = '0'
    left join company supply on supply.comId = sm.supplyComId
    left join buyMateriel bm on bm.materielId = m.materielId and bm.delFlg = '0'
LEFT JOIN category ca on ca.categoryId = m.type
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      group by m.serialNum
      order by ${orderByClause}
    </if>
  ) t
  <if test="searchStr != null" >
  	where 
  	t.materielNum  like CONCAT('%',#{searchStr,jdbcType=VARCHAR},'%')
  	or t.materielName  like CONCAT('%',#{searchStr,jdbcType=VARCHAR},'%')
    </if>
    <if test="length != 0" >
      limit #{start},#{length}
    </if>
  </select>
  
  
  <select id="selectListCountBySelectExample" resultType="java.lang.String" parameterType="com.congmai.zhgj.web.model.MaterielSelectExample" >
SELECT count(t.serialNum) from(
    SELECT DISTINCT m.serialNum,m.materielNum,m.materielName
from materiel m 
    left join supplyMateriel sm on sm.materielId = m.materielId and sm.delFlg = '0'
    left join company supply on supply.comId = sm.supplyComId
    left join buyMateriel bm on bm.materielId = m.materielId and bm.delFlg = '0'
LEFT JOIN category ca on ca.categoryId = m.type
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
) t <if test="searchStr != null" >
  	where 
  	t.materielNum  like CONCAT('%',#{searchStr,jdbcType=VARCHAR},'%')
  	or t.materielName  like CONCAT('%',#{searchStr,jdbcType=VARCHAR},'%')
    </if>
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from materiel
    where serialNum = #{serialNum,jdbcType=VARCHAR}
  </select>
  
    
  <select id="selectDifferentMaterielByOrderSerial" resultMap="BaseResultMap4Order" parameterType="java.lang.String" >
    SELECT 
		m.serialNum,
		m.materielId,
		m.materielNum,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.materielName 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.materielName 
		ELSE m.materielName END ) as materielName,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.specifications 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.specifications 
		ELSE m.specifications END ) as specifications,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.unit 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.unit 
		ELSE m.unit END ) as unit,
		m.parentMaterielSerial,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.type 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.type 
		ELSE m.type END ) as type,
		m.productionPlace,
		m.brand,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.category1 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.category1 
		ELSE m.category1 END ) as category1,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.category2 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.category2 
		ELSE m.category2 END ) as category2,
		(CASE WHEN o.buyComId is null and sm.serialNum is not null THEN sm.category3 
		     WHEN o.supplyComId is null and bm.serialNum is not null THEN bm.category3 
		ELSE m.category3 END ) as category3,
		m.materielAttribute,
		m.mnemonicCode,
		m.isBOM,
		m.stockUnit,
		m.originCountry,
		m.width,
		m.height,
		m.length,
		m.currency,
		m.unitPrice,
		m.deliveryCycle,
		m.filingItemNo,
		m.volume,
		m.weight,
		m.palletSpecification,
		m.manufactureDate,
		m.remark,
		m.customsSupervisionConditions,
		m.customsCode,
		m.qualityDate,
		m.packageNum,
		m.packageSpecifications,
		m.packageUnit,
		m.packagewidth,
		m.packageheight,
		m.packagelength,
		m.packagevolume,
		m.packageUnitConversion,
		m.palletWeight,
		m.versionNO,
		m.isLatestVersion,
		m.`status`,
		m.delFlg,
		m.creator,
		m.createTime,
		m.updater,
		m.updateTime
		
	from orderMateriel om
	LEFT JOIN orderInfo o on o.serialNum = om.orderSerial
	LEFT JOIN materiel m on m.serialNum = om.materielSerial
	LEFT JOIN buyMateriel bm on bm.materielId =  m.materielId and bm.delFlg = 0 and o.buyComId = bm.buyComId
	LEFT JOIN supplyMateriel sm on sm.materielId =  m.materielId and sm.delFlg = 0 and o.supplyComId = sm.supplyComId
	
	WHERE om.serialNum = #{serialNum,jdbcType=VARCHAR}
	limit 1
  </select>
  
  
  
    <select id="selectByMaterielId" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from materiel
    where materielId = #{materielId,jdbcType=VARCHAR}
    and delFlg = 0
    and isLatestVersion = 1
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from materiel
    where serialNum = #{serialNum,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.congmai.zhgj.web.model.MaterielExample" >
    delete from materiel
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.congmai.zhgj.web.model.Materiel" >
    insert into materiel (serialNum, materielId, materielNum, 
      materielName, specifications, unit, 
      parentMaterielSerial, type, productionPlace, 
      brand, category1,category2, category3,materielAttribute, MnemonicCode, 
      isBOM, stockUnit, originCountry, 
      width, height, length, 
      currency, unitPrice, deliveryCycle,filingItemNo, 
      volume, weight, palletSpecification, 
      manufactureDate, remark, packageNum, 
      packageSpecifications, packageUnit, packagewidth, 
      packageheight, packagelength, packagevolume, 
      packageUnitConversion, palletWeight, customsSupervisionConditions, customsCode,
      qualityDate, versionNO, isLatestVersion, 
      status, creator, 
      createTime, updater, updateTime
      )
    values (#{serialNum,jdbcType=VARCHAR}, #{materielId,jdbcType=VARCHAR}, #{materielNum,jdbcType=VARCHAR}, 
      #{materielName,jdbcType=VARCHAR}, #{specifications,jdbcType=VARCHAR}, #{unit,jdbcType=VARCHAR}, 
      #{parentMaterielSerial,jdbcType=VARCHAR}, #{type,jdbcType=VARCHAR}, #{productionPlace,jdbcType=VARCHAR}, 
      #{brand,jdbcType=VARCHAR},#{category1,jdbcType=VARCHAR}, #{category2,jdbcType=VARCHAR},#{category3,jdbcType=VARCHAR},#{materielAttribute,jdbcType=VARCHAR},#{mnemonicCode,jdbcType=VARCHAR}, 
      #{isBOM,jdbcType=VARCHAR}, #{stockUnit,jdbcType=VARCHAR}, #{originCountry,jdbcType=VARCHAR}, 
      #{width,jdbcType=VARCHAR}, #{height,jdbcType=VARCHAR}, #{length,jdbcType=VARCHAR}, 
      #{currency,jdbcType=VARCHAR}, #{unitPrice,jdbcType=VARCHAR},#{deliveryCycle,jdbcType=VARCHAR} ,#{filingItemNo,jdbcType=VARCHAR}, 
      #{volume,jdbcType=VARCHAR}, #{weight,jdbcType=VARCHAR}, #{palletSpecification,jdbcType=VARCHAR}, 
      #{manufactureDate,jdbcType=DATE}, #{remark,jdbcType=VARCHAR}, #{packageNum,jdbcType=VARCHAR}, 
      #{packageSpecifications,jdbcType=VARCHAR}, #{packageUnit,jdbcType=VARCHAR}, #{packagewidth,jdbcType=VARCHAR}, 
      #{packageheight,jdbcType=VARCHAR}, #{packagelength,jdbcType=VARCHAR}, #{packagevolume,jdbcType=VARCHAR}, 
      #{packageUnitConversion,jdbcType=VARCHAR}, #{palletWeight,jdbcType=VARCHAR}, #{customsSupervisionConditions,jdbcType=VARCHAR}, #{customsCode,jdbcType=VARCHAR},
      #{qualityDate,jdbcType=VARCHAR}, #{versionNO,jdbcType=VARCHAR}, #{isLatestVersion,jdbcType=VARCHAR}, 
      #{status,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=TIMESTAMP}, #{updater,jdbcType=VARCHAR}, #{updateTime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.congmai.zhgj.web.model.Materiel" >
    insert into materiel
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="serialNum != null" >
        serialNum,
      </if>
      <if test="materielId != null" >
        materielId,
      </if>
      <if test="materielNum != null" >
        materielNum,
      </if>
      <if test="materielName != null" >
        materielName,
      </if>
      <if test="specifications != null" >
        specifications,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="parentMaterielSerial != null" >
        parentMaterielSerial,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="productionPlace != null" >
        productionPlace,
      </if>
      <if test="brand != null" >
        brand,
      </if>
      <if test="category1 != null" >
        category1,
      </if>
      <if test="category2 != null" >
        category2,
      </if>
      <if test="category3 != null" >
        category3,
      </if>
      <if test="materielAttribute != null" >
        materielAttribute,
      </if>
      <if test="mnemonicCode != null" >
        MnemonicCode,
      </if>
      <if test="isBOM != null" >
        isBOM,
      </if>
      <if test="stockUnit != null" >
        stockUnit,
      </if>
      <if test="originCountry != null" >
        originCountry,
      </if>
      <if test="width != null" >
        width,
      </if>
      <if test="height != null" >
        height,
      </if>
      <if test="length != null" >
        length,
      </if>
      <if test="currency != null" >
        currency,
      </if>
      <if test="unitPrice != null" >
        unitPrice,
      </if>
      <if test="deliveryCycle != null" >
        deliveryCycle,
      </if>
      <if test="filingItemNo != null" >
        filingItemNo,
      </if>
      <if test="volume != null" >
        volume,
      </if>
      <if test="weight != null" >
        weight,
      </if>
      <if test="palletSpecification != null" >
        palletSpecification,
      </if>
      <if test="manufactureDate != null" >
        manufactureDate,
      </if>
      <if test="remark != null" >
        remark,
      </if>
      <if test="packageNum != null" >
        packageNum,
      </if>
      <if test="packageSpecifications != null" >
        packageSpecifications,
      </if>
      <if test="packageUnit != null" >
        packageUnit,
      </if>
      <if test="packagewidth != null" >
        packagewidth,
      </if>
      <if test="packageheight != null" >
        packageheight,
      </if>
      <if test="packagelength != null" >
        packagelength,
      </if>
      <if test="packagevolume != null" >
        packagevolume,
      </if>
      <if test="packageUnitConversion != null" >
        packageUnitConversion,
      </if>
      <if test="palletWeight != null" >
        palletWeight,
      </if>
      <if test="customsSupervisionConditions != null" >
        customsSupervisionConditions,
      </if>
      <if test="customsCode != null" >
        customsCode,
      </if>
      <if test="qualityDate != null" >
        qualityDate,
      </if>
      <if test="versionNO != null" >
        versionNO,
      </if>
      <if test="isLatestVersion != null" >
        isLatestVersion,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="delFlg != null" >
        delFlg,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="createTime != null" >
        createTime,
      </if>
      <if test="updater != null" >
        updater,
      </if>
      <if test="updateTime != null" >
        updateTime,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="serialNum != null" >
        #{serialNum,jdbcType=VARCHAR},
      </if>
      <if test="materielId != null" >
        #{materielId,jdbcType=VARCHAR},
      </if>
      <if test="materielNum != null" >
        #{materielNum,jdbcType=VARCHAR},
      </if>
      <if test="materielName != null" >
        #{materielName,jdbcType=VARCHAR},
      </if>
      <if test="specifications != null" >
        #{specifications,jdbcType=VARCHAR},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="parentMaterielSerial != null" >
        #{parentMaterielSerial,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="productionPlace != null" >
        #{productionPlace,jdbcType=VARCHAR},
      </if>
      <if test="brand != null" >
        #{brand,jdbcType=VARCHAR},
      </if>
      <if test="category1 != null" >
        #{category1,jdbcType=VARCHAR},
      </if>
      <if test="category2 != null" >
        #{category2,jdbcType=VARCHAR},
      </if>
      <if test="category3 != null" >
        #{category3,jdbcType=VARCHAR},
      </if>
      <if test="materielAttribute != null" >
        #{materielAttribute,jdbcType=VARCHAR},
      </if>
      <if test="mnemonicCode != null" >
        #{mnemonicCode,jdbcType=VARCHAR},
      </if>
      <if test="isBOM != null" >
        #{isBOM,jdbcType=VARCHAR},
      </if>
      <if test="stockUnit != null" >
        #{stockUnit,jdbcType=VARCHAR},
      </if>
      <if test="originCountry != null" >
        #{originCountry,jdbcType=VARCHAR},
      </if>
      <if test="width != null" >
        #{width,jdbcType=VARCHAR},
      </if>
      <if test="height != null" >
        #{height,jdbcType=VARCHAR},
      </if>
      <if test="length != null" >
        #{length,jdbcType=VARCHAR},
      </if>
      <if test="currency != null" >
        #{currency,jdbcType=VARCHAR},
      </if>
      <if test="unitPrice != null" >
        #{unitPrice,jdbcType=VARCHAR},
      </if>
      <if test="deliveryCycle != null" >
        #{deliveryCycle,jdbcType=VARCHAR},
      </if>
      <if test="filingItemNo != null" >
        #{filingItemNo,jdbcType=VARCHAR},
      </if>
      <if test="volume != null" >
        #{volume,jdbcType=VARCHAR},
      </if>
      <if test="weight != null" >
        #{weight,jdbcType=VARCHAR},
      </if>
      <if test="palletSpecification != null" >
        #{palletSpecification,jdbcType=VARCHAR},
      </if>
      <if test="manufactureDate != null" >
        #{manufactureDate,jdbcType=DATE},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="packageNum != null" >
        #{packageNum,jdbcType=VARCHAR},
      </if>
      <if test="packageSpecifications != null" >
        #{packageSpecifications,jdbcType=VARCHAR},
      </if>
      <if test="packageUnit != null" >
        #{packageUnit,jdbcType=VARCHAR},
      </if>
      <if test="packagewidth != null" >
        #{packagewidth,jdbcType=VARCHAR},
      </if>
      <if test="packageheight != null" >
        #{packageheight,jdbcType=VARCHAR},
      </if>
      <if test="packagelength != null" >
        #{packagelength,jdbcType=VARCHAR},
      </if>
      <if test="packagevolume != null" >
        #{packagevolume,jdbcType=VARCHAR},
      </if>
      <if test="packageUnitConversion != null" >
        #{packageUnitConversion,jdbcType=VARCHAR},
      </if>
      <if test="palletWeight != null" >
        #{palletWeight,jdbcType=VARCHAR},
      </if>
      <if test="customsSupervisionConditions != null" >
        #{customsSupervisionConditions,jdbcType=VARCHAR},
      </if>
      <if test="customsCode != null" >
        #{customsCode,jdbcType=VARCHAR},
      </if>
      <if test="qualityDate != null" >
        #{qualityDate,jdbcType=VARCHAR},
      </if>
      <if test="versionNO != null" >
        #{versionNO,jdbcType=VARCHAR},
      </if>
      <if test="isLatestVersion != null" >
        #{isLatestVersion,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="delFlg != null" >
        #{delFlg,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updater != null" >
        #{updater,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.congmai.zhgj.web.model.MaterielExample" resultType="java.lang.Integer" >
    select count(*) from materiel
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  
  <update id="updateByPrimaryKeySelective" parameterType="com.congmai.zhgj.web.model.Materiel" >
    update materiel
    <set >
      <if test="materielId != null" >
        materielId = #{materielId,jdbcType=VARCHAR},
      </if>
      <if test="materielNum != null" >
        materielNum = #{materielNum,jdbcType=VARCHAR},
      </if>
      <if test="materielName != null" >
        materielName = #{materielName,jdbcType=VARCHAR},
      </if>
      <if test="specifications != null" >
        specifications = #{specifications,jdbcType=VARCHAR},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="parentMaterielSerial != null" >
        parentMaterielSerial = #{parentMaterielSerial,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        type = #{type,jdbcType=VARCHAR},
      </if>
      <if test="productionPlace != null" >
        productionPlace = #{productionPlace,jdbcType=VARCHAR},
      </if>
      <if test="brand != null" >
        brand = #{brand,jdbcType=VARCHAR},
      </if>
      <if test="category1 != null" >
        category1 = #{category1,jdbcType=VARCHAR},
      </if>
      <if test="category2 != null" >
        category2 = #{category2,jdbcType=VARCHAR},
      </if>
      <if test="category3 != null" >
        category3 = #{category3,jdbcType=VARCHAR},
      </if>
      <if test="materielAttribute != null" >
        materielAttribute = #{materielAttribute,jdbcType=VARCHAR},
      </if>
      <if test="mnemonicCode != null" >
        MnemonicCode = #{mnemonicCode,jdbcType=VARCHAR},
      </if>
      <if test="isBOM != null" >
        isBOM = #{isBOM,jdbcType=VARCHAR},
      </if>
      <if test="stockUnit != null" >
        stockUnit = #{stockUnit,jdbcType=VARCHAR},
      </if>
      <if test="originCountry != null" >
        originCountry = #{originCountry,jdbcType=VARCHAR},
      </if>
      <if test="width != null" >
        width = #{width,jdbcType=VARCHAR},
      </if>
      <if test="height != null" >
        height = #{height,jdbcType=VARCHAR},
      </if>
      <if test="length != null" >
        length = #{length,jdbcType=VARCHAR},
      </if>
      <if test="currency != null" >
        currency = #{currency,jdbcType=VARCHAR},
      </if>
      <if test="unitPrice != null" >
        unitPrice = #{unitPrice,jdbcType=VARCHAR},
      </if>
      <if test="deliveryCycle != null" >
        deliveryCycle = #{deliveryCycle,jdbcType=VARCHAR},
      </if>
      <if test="filingItemNo != null" >
        filingItemNo = #{filingItemNo,jdbcType=VARCHAR},
      </if>
      <if test="volume != null" >
        volume = #{volume,jdbcType=VARCHAR},
      </if>
      <if test="weight != null" >
        weight = #{weight,jdbcType=VARCHAR},
      </if>
      <if test="palletSpecification != null" >
        palletSpecification = #{palletSpecification,jdbcType=VARCHAR},
      </if>
      <if test="manufactureDate != null" >
        manufactureDate = #{manufactureDate,jdbcType=DATE},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="packageNum != null" >
        packageNum = #{packageNum,jdbcType=VARCHAR},
      </if>
      <if test="packageSpecifications != null" >
        packageSpecifications = #{packageSpecifications,jdbcType=VARCHAR},
      </if>
      <if test="packageUnit != null" >
        packageUnit = #{packageUnit,jdbcType=VARCHAR},
      </if>
      <if test="packagewidth != null" >
        packagewidth = #{packagewidth,jdbcType=VARCHAR},
      </if>
      <if test="packageheight != null" >
        packageheight = #{packageheight,jdbcType=VARCHAR},
      </if>
      <if test="packagelength != null" >
        packagelength = #{packagelength,jdbcType=VARCHAR},
      </if>
      <if test="packagevolume != null" >
        packagevolume = #{packagevolume,jdbcType=VARCHAR},
      </if>
      <if test="packageUnitConversion != null" >
        packageUnitConversion = #{packageUnitConversion,jdbcType=VARCHAR},
      </if>
      <if test="palletWeight != null" >
        palletWeight = #{palletWeight,jdbcType=VARCHAR},
      </if>
      <if test="customsSupervisionConditions != null" >
        customsSupervisionConditions = #{customsSupervisionConditions,jdbcType=VARCHAR},
      </if>
      <if test="customsCode != null" >
        customsCode = #{customsCode,jdbcType=VARCHAR},
      </if>
      <if test="qualityDate != null" >
        qualityDate = #{qualityDate,jdbcType=VARCHAR},
      </if>
      <if test="versionNO != null" >
        versionNO = #{versionNO,jdbcType=VARCHAR},
      </if>
      <if test="isLatestVersion != null" >
        isLatestVersion = #{isLatestVersion,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="delFlg != null" >
        delFlg = #{delFlg,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        createTime = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updater != null" >
        updater = #{updater,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        updateTime = #{updateTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where serialNum = #{serialNum,jdbcType=VARCHAR}
  </update>
  <delete id="deleteMateriels" parameterType="java.util.List">
    	delete from serialNum where id in
        <foreach item="idList" collection="list" open="(" close=")" separator=",">
            #{idList}
        </foreach>
    </delete>
    
    <update id="updateByExampleSelective" parameterType="map" >
    update materiel
    <set >
      <if test="record.serialNum != null" >
        serialNum = #{record.serialNum,jdbcType=VARCHAR},
      </if>
      <if test="record.materielId != null" >
        materielId = #{record.materielId,jdbcType=VARCHAR},
      </if>
      <if test="record.materielNum != null" >
        materielNum = #{record.materielNum,jdbcType=VARCHAR},
      </if>
      <if test="record.materielName != null" >
        materielName = #{record.materielName,jdbcType=VARCHAR},
      </if>
      <if test="record.specifications != null" >
        specifications = #{record.specifications,jdbcType=VARCHAR},
      </if>
      <if test="record.unit != null" >
        unit = #{record.unit,jdbcType=VARCHAR},
      </if>
      <if test="record.parentMaterielSerial != null" >
        parentMaterielSerial = #{record.parentMaterielSerial,jdbcType=VARCHAR},
      </if>
      <if test="record.type != null" >
        type = #{record.type,jdbcType=VARCHAR},
      </if>
      <if test="record.productionPlace != null" >
        productionPlace = #{record.productionPlace,jdbcType=VARCHAR},
      </if>
      <if test="record.brand != null" >
        brand = #{record.brand,jdbcType=VARCHAR},
      </if>
      <if test="record.category1 != null" >
        category1 = #{record.category1,jdbcType=VARCHAR},
      </if>
      <if test="record.category2 != null" >
        category2 = #{record.category2,jdbcType=VARCHAR},
      </if>
      <if test="record.category3 != null" >
        category3 = #{record.category3,jdbcType=VARCHAR},
      </if>
      <if test="record.materielAttribute != null" >
        materielAttribute = #{record.materielAttribute,jdbcType=VARCHAR},
      </if>
      <if test="record.mnemonicCode != null" >
        MnemonicCode = #{record.mnemonicCode,jdbcType=VARCHAR},
      </if>
      <if test="record.isBOM != null" >
        isBOM = #{record.isBOM,jdbcType=VARCHAR},
      </if>
      <if test="record.stockUnit != null" >
        stockUnit = #{record.stockUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.originCountry != null" >
        originCountry = #{record.originCountry,jdbcType=VARCHAR},
      </if>
      <if test="record.width != null" >
        width = #{record.width,jdbcType=VARCHAR},
      </if>
      <if test="record.height != null" >
        height = #{record.height,jdbcType=VARCHAR},
      </if>
      <if test="record.length != null" >
        length = #{record.length,jdbcType=VARCHAR},
      </if>
      <if test="record.currency != null" >
        currency = #{record.currency,jdbcType=VARCHAR},
      </if>
      <if test="record.unitPrice != null" >
        unitPrice = #{record.unitPrice,jdbcType=VARCHAR},
      </if>
      <if test="record.deliveryCycle != null" >
        deliveryCycle = #{record.deliveryCycle,jdbcType=VARCHAR},
      </if>
      <if test="record.filingItemNo != null" >
        filingItemNo = #{record.filingItemNo,jdbcType=VARCHAR},
      </if>
      <if test="record.volume != null" >
        volume = #{record.volume,jdbcType=VARCHAR},
      </if>
      <if test="record.weight != null" >
        weight = #{record.weight,jdbcType=VARCHAR},
      </if>
      <if test="record.palletSpecification != null" >
        palletSpecification = #{record.palletSpecification,jdbcType=VARCHAR},
      </if>
      <if test="record.manufactureDate != null" >
        manufactureDate = #{record.manufactureDate,jdbcType=DATE},
      </if>
      <if test="record.remark != null" >
        remark = #{record.remark,jdbcType=VARCHAR},
      </if>
      <if test="record.packageNum != null" >
        packageNum = #{record.packageNum,jdbcType=VARCHAR},
      </if>
      <if test="record.packageSpecifications != null" >
        packageSpecifications = #{record.packageSpecifications,jdbcType=VARCHAR},
      </if>
      <if test="record.packageUnit != null" >
        packageUnit = #{record.packageUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.packagewidth != null" >
        packagewidth = #{record.packagewidth,jdbcType=VARCHAR},
      </if>
      <if test="record.packageheight != null" >
        packageheight = #{record.packageheight,jdbcType=VARCHAR},
      </if>
      <if test="record.packagelength != null" >
        packagelength = #{record.packagelength,jdbcType=VARCHAR},
      </if>
      <if test="record.packagevolume != null" >
        packagevolume = #{record.packagevolume,jdbcType=VARCHAR},
      </if>
      <if test="record.packageUnitConversion != null" >
        packageUnitConversion = #{record.packageUnitConversion,jdbcType=VARCHAR},
      </if>
      <if test="record.palletWeight != null" >
        palletWeight = #{record.palletWeight,jdbcType=VARCHAR},
      </if>
      <if test="record.customsSupervisionConditions != null" >
        customsSupervisionConditions = #{record.customsSupervisionConditions,jdbcType=VARCHAR},
      </if>
      <if test="record.customsCode != null" >
        customsCode = #{record.customsCode,jdbcType=VARCHAR},
      </if>
      <if test="record.qualityDate != null" >
        qualityDate = #{record.qualityDate,jdbcType=VARCHAR},
      </if>
      <if test="record.versionNO != null" >
        versionNO = #{record.versionNO,jdbcType=VARCHAR},
      </if>
      <if test="record.isLatestVersion != null" >
        isLatestVersion = #{record.isLatestVersion,jdbcType=VARCHAR},
      </if>
      <if test="record.status != null" >
        status = #{record.status,jdbcType=VARCHAR},
      </if>
      <if test="record.delFlg != null" >
        delFlg = #{record.delFlg,jdbcType=VARCHAR},
      </if>
      <if test="record.creator != null" >
        creator = #{record.creator,jdbcType=VARCHAR},
      </if>
      <if test="record.createTime != null" >
        createTime = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.updater != null" >
        updater = #{record.updater,jdbcType=VARCHAR},
      </if>
      <if test="record.updateTime != null" >
        updateTime = #{record.updateTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <select id="selectMaterielByOrderSerial"   parameterType="java.util.Map"   resultType="com.congmai.zhgj.web.model.Materiel">
  select   DISTINCT om.serialNum as serialNum,m.materielNum,m.materielName,m.unit , m.specifications, om.amount  as amount ,
  IFNULL(om.canBillAmount,om.amount)  AS canBillAmount,om.orderUnitPrice  as orderUnitPrice,o.rate,o.currency,om.customsCode,om.customsRate,om.orderRateUnit  as orderRateUnit
  <if test="invoiceSerial!=null">
  , IFNULL(ibr.billCount,0) as billAmount
  ,ibr.serialNum as invoiceBillingRecordSerial
  </if>
  <if test="invoiceSerial==null">
  , 0 as billAmount
  </if>
   <if test="deliverySerial!=null and isClearance=='1'.toString()">
  , dm.deliverCount as deliverCount
  </if>
  <if test="deliverySerial!=null  and isClearance!='1'.toString()">
  , dm.stockCount as deliverCount
  </if>
  from  orderMateriel om
  left join materiel m  on  om.materielSerial=m.serialNum
  left  join orderInfo o  on  o.serialNum=om.orderSerial
    <if test="invoiceSerial!=null">
   left join invoiceBillingRecord ibr on   ibr.orderMaterielSerial=om.serialNum 
   </if>
    <if test="deliverySerial!=null">
   left join deliveryMateriel dm  on   dm.orderMaterielSerial=om.serialNum and dm.deliverSerial=#{deliverySerial,jdbcType=VARCHAR} and dm.delFlg=0
   </if>
  where  om.orderSerial=#{orderSerial,jdbcType=VARCHAR}  and om.delFlg=0
  <if test="invoiceSerial!=null">
   and  ibr.invoiceSerial=#{invoiceSerial,jdbcType=VARCHAR} 
   </if>
    <if test="deliverySerial!=null">
 and dm.deliverCount is not null and  dm.deliverCount!=0
  </if>
  </select>
</mapper>